@app.route('/add_project', methods=['POST'])
def add_project():
    if request.method == 'POST':
        التسلسل = request.form['التسلسل']
        المحافظة = request.form['المحافظة']
        المشروع = request.form['المشروع']
        مدرج_في_وزارة_التخطيط = request.form['مدرج_في_وزارة_التخطيط']
        مؤشر_لدى_وزارة_المالية = request.form['مؤشر_لدى_وزارة_المالية']
        الكلفة_الكلية = request.form['الكلفة_الكلية']
        الاستثناء_من_أساليب_التعاقد = request.form['الاستثناء_من_أساليب_التعاقد']
        استثناء = request.form['استثناء']
        الإعلان = request.form['الإعلان']
        دراسة_سيرة_ذاتية = request.form['دراسة_سيرة_ذاتية']
        الدعوات = 'الدعوات' in request.form
        الوثيقة_القياسية = 'الوثيقة_القياسية' in request.form
        التخويل = 'التخويل' in request.form
        تاريخ_غلق_الدعوات = request.form['تاريخ_غلق_الدعوات']
        لجان_الفتح = 'لجان_الفتح' in request.form
        لجنة_تحليل = request.form['لجنة_تحليل']
        قرار_لجنة_التحليل = request.form['قرار_لجنة_التحليل']
        لجنة_المراجعة_والمصادقة = request.form['لجنة_المراجعة_والمصادقة']
        الإحالة = request.form['الإحالة']
        مسودة_العقد = request.form['مسودة_العقد']
        توقيع_العقد = request.form['توقيع_العقد']
        ملاحظات = request.form['ملاحظات']

        # تنفيذ استعلام الإدخال
        query = """
        INSERT INTO projects (التسلسل, المحافظة, المشروع, مدرج_في_وزارة_التخطيط, مؤشر_لدى_وزارة_المالية, الكلفة_الكلية,
        الاستثناء_من_أساليب_التعاقد, استثناء, الإعلان, دراسة_سيرة_ذاتية, الدعوات, الوثيقة_القياسية, التخويل,
        تاريخ_غلق_الدعوات, لجان_الفتح, لجنة_تحليل, قرار_لجنة_التحليل, لجنة_المراجعة_والمصادقة, الإحالة,
        مسودة_العقد, توقيع_العقد, ملاحظات)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        """
        values = (التسلسل, المحافظة, المشروع, مدرج_في_وزارة_التخطيط, مؤشر_لدى_وزارة_المالية, الكلفة_الكلية,
                  الاستثناء_من_أساليب_التعاقد, استثناء, الإعلان, دراسة_سيرة_ذاتية, الدعوات, الوثيقة_القياسية, التخويل,
                  تاريخ_غلق_الدعوات, لجان_الفتح, لجنة_تحليل, قرار_لجنة_التحليل, لجنة_المراجعة_والمصادقة, الإحالة,
                  مسودة_العقد, توقيع_العقد, ملاحظات)

        conn = get_db_connection()
        conn.execute(query, values)
        conn.commit()
        conn.close()

        flash('تمت إضافة المشروع بنجاح!', 'success')
        return redirect(url_for('home'))
